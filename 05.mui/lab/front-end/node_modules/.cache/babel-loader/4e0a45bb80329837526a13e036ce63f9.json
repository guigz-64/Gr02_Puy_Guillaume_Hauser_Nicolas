{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\nicob\\\\OneDrive\\\\Documents\\\\GitHub\\\\Gr02_Puy_Guillaume_Hauser_Nicolas\\\\05.mui\\\\lab\\\\front-end\\\\src\\\\channel\\\\List.js\";\nimport { forwardRef, useImperativeHandle, useLayoutEffect, useRef } from 'react';\n/** @jsx jsx */\n\nimport { jsx } from '@emotion/core'; // Layout\n\nimport { useTheme } from '@material-ui/core/styles'; // Markdown\n\nimport unified from 'unified';\nimport markdown from 'remark-parse';\nimport remark2rehype from 'remark-rehype';\nimport html from 'rehype-stringify'; // Time\n\nimport dayjs from 'dayjs';\nimport calendar from 'dayjs/plugin/calendar';\nimport updateLocale from 'dayjs/plugin/updateLocale';\ndayjs.extend(calendar);\ndayjs.extend(updateLocale);\ndayjs.updateLocale('en', {\n  calendar: {\n    sameElse: 'DD/MM/YYYY hh:mm A'\n  }\n});\n\nconst useStyles = theme => ({\n  root: {\n    position: 'relative',\n    flex: '1 1 auto',\n    overflow: 'auto',\n    '& ul': {\n      'margin': 0,\n      'padding': 0,\n      'textIndent': 0,\n      'listStyleType': 0\n    }\n  },\n  message: {\n    padding: '.2rem .5rem',\n    ':hover': {\n      backgroundColor: 'rgba(255,255,255,.05)'\n    }\n  },\n  fabWrapper: {\n    position: 'absolute',\n    right: 0,\n    top: 0,\n    width: '50px'\n  },\n  fab: {\n    position: 'fixed !important',\n    top: 0,\n    width: '50px'\n  }\n});\n\nexport default forwardRef(({\n  channel,\n  messages,\n  onScrollDown\n}, ref) => {\n  const styles = useStyles(useTheme()); // Expose the `scroll` action\n\n  useImperativeHandle(ref, () => ({\n    scroll: scroll\n  }));\n  const rootEl = useRef(null);\n  const scrollEl = useRef(null);\n\n  const scroll = () => {\n    scrollEl.current.scrollIntoView();\n  }; // See https://dev.to/n8tb1t/tracking-scroll-position-with-react-hooks-3bbj\n\n\n  const throttleTimeout = useRef(null); // react-hooks/exhaustive-deps\n\n  useLayoutEffect(() => {\n    const rootNode = rootEl.current; // react-hooks/exhaustive-deps\n\n    const handleScroll = () => {\n      if (throttleTimeout.current === null) {\n        throttleTimeout.current = setTimeout(() => {\n          throttleTimeout.current = null;\n          const {\n            scrollTop,\n            offsetHeight,\n            scrollHeight\n          } = rootNode; // react-hooks/exhaustive-deps\n\n          onScrollDown(scrollTop + offsetHeight < scrollHeight);\n        }, 200);\n      }\n    };\n\n    handleScroll();\n    rootNode.addEventListener('scroll', handleScroll);\n    return () => rootNode.removeEventListener('scroll', handleScroll);\n  });\n  return jsx(\"div\", {\n    css: styles.root,\n    ref: rootEl\n  }, jsx(\"h1\", null, \"Messages for \", channel.name), jsx(\"ul\", null, messages.map((message, i) => {\n    const {\n      contents: content\n    } = unified().use(markdown).use(remark2rehype).use(html).processSync(message.content);\n    return jsx(\"li\", {\n      key: i,\n      css: styles.message\n    }, jsx(\"p\", null, jsx(\"span\", null, message.author), ' - ', jsx(\"span\", null, dayjs().calendar(message.creation))), jsx(\"div\", {\n      dangerouslySetInnerHTML: {\n        __html: content\n      }\n    }));\n  })), jsx(\"div\", {\n    ref: scrollEl\n  }));\n});","map":{"version":3,"sources":["C:/Users/nicob/OneDrive/Documents/GitHub/Gr02_Puy_Guillaume_Hauser_Nicolas/05.mui/lab/front-end/src/channel/List.js"],"names":["forwardRef","useImperativeHandle","useLayoutEffect","useRef","jsx","useTheme","unified","markdown","remark2rehype","html","dayjs","calendar","updateLocale","extend","sameElse","useStyles","theme","root","position","flex","overflow","message","padding","backgroundColor","fabWrapper","right","top","width","fab","channel","messages","onScrollDown","ref","styles","scroll","rootEl","scrollEl","current","scrollIntoView","throttleTimeout","rootNode","handleScroll","setTimeout","scrollTop","offsetHeight","scrollHeight","addEventListener","removeEventListener","name","map","i","contents","content","use","processSync","author","creation","__html"],"mappings":"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","sourcesContent":["import {forwardRef, useImperativeHandle, useLayoutEffect, useRef} from 'react'\r\n/** @jsx jsx */\r\nimport { jsx } from '@emotion/core'\r\n// Layout\r\nimport { useTheme } from '@material-ui/core/styles';\r\n// Markdown\r\nimport unified from 'unified'\r\nimport markdown from 'remark-parse'\r\nimport remark2rehype from 'remark-rehype'\r\nimport html from 'rehype-stringify'\r\n// Time\r\nimport dayjs from 'dayjs'\r\nimport calendar from 'dayjs/plugin/calendar'\r\nimport updateLocale from 'dayjs/plugin/updateLocale'\r\ndayjs.extend(calendar)\r\ndayjs.extend(updateLocale)\r\ndayjs.updateLocale('en', {\r\n  calendar: {\r\n    sameElse: 'DD/MM/YYYY hh:mm A'\r\n  }\r\n})\r\n\r\nconst useStyles = (theme) => ({\r\n  root: {\r\n    position: 'relative',\r\n    flex: '1 1 auto',\r\n    overflow: 'auto',\r\n    '& ul': {\r\n      'margin': 0,\r\n      'padding': 0,\r\n      'textIndent': 0,\r\n      'listStyleType': 0,\r\n    },\r\n  },\r\n  message: {\r\n    padding: '.2rem .5rem',\r\n    ':hover': {\r\n      backgroundColor: 'rgba(255,255,255,.05)',\r\n    },\r\n  },\r\n  fabWrapper: {\r\n    position: 'absolute',\r\n    right: 0,\r\n    top: 0,\r\n    width: '50px',\r\n  },\r\n  fab: {\r\n    position: 'fixed !important',\r\n    top: 0,\r\n    width: '50px',\r\n  },\r\n})\r\n\r\nexport default forwardRef(({\r\n  channel,\r\n  messages,\r\n  onScrollDown,\r\n}, ref) => {\r\n  const styles = useStyles(useTheme())\r\n  // Expose the `scroll` action\r\n  useImperativeHandle(ref, () => ({\r\n    scroll: scroll\r\n  }));\r\n  const rootEl = useRef(null)\r\n  const scrollEl = useRef(null)\r\n  const scroll = () => {\r\n    scrollEl.current.scrollIntoView()\r\n  }\r\n  // See https://dev.to/n8tb1t/tracking-scroll-position-with-react-hooks-3bbj\r\n  const throttleTimeout = useRef(null) // react-hooks/exhaustive-deps\r\n  useLayoutEffect( () => {\r\n    const rootNode = rootEl.current // react-hooks/exhaustive-deps\r\n    const handleScroll = () => {\r\n      if (throttleTimeout.current === null) {\r\n        throttleTimeout.current = setTimeout(() => {\r\n          throttleTimeout.current = null\r\n          const {scrollTop, offsetHeight, scrollHeight} = rootNode // react-hooks/exhaustive-deps\r\n          onScrollDown(scrollTop + offsetHeight < scrollHeight)\r\n        }, 200)\r\n      }\r\n    }\r\n    handleScroll()\r\n    rootNode.addEventListener('scroll', handleScroll)\r\n    return () => rootNode.removeEventListener('scroll', handleScroll)\r\n  })\r\n  return (\r\n    <div css={styles.root} ref={rootEl}>\r\n      <h1>Messages for {channel.name}</h1>\r\n      <ul>\r\n        { messages.map( (message, i) => {\r\n            const {contents: content} = unified()\r\n            .use(markdown)\r\n            .use(remark2rehype)\r\n            .use(html)\r\n            .processSync(message.content)\r\n            return (\r\n              <li key={i} css={styles.message}>\r\n                <p>\r\n                  <span>{message.author}</span>\r\n                  {' - '}\r\n                  <span>{dayjs().calendar(message.creation)}</span>\r\n                </p>\r\n                <div dangerouslySetInnerHTML={{__html: content}}>\r\n                </div>\r\n              </li>\r\n            )\r\n        })}\r\n      </ul>\r\n      <div ref={scrollEl} />\r\n    </div>\r\n  )\r\n})\r\n"]},"metadata":{},"sourceType":"module"}